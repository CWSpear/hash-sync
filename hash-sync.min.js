angular.module("HashSync",[]).directive("hashSync",["$location","$parse",function(e,t){function n(e){return typeof e!="undefined"}function r(e){try{return decodeURIComponent(e)}catch(t){}}function i(e,t){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,t?"%20":"+")}function s(e){var t={},n,i;angular.forEach((e||"").split("&"),function(e){if(e){n=e.split("=");i=r(n[0]);if(angular.isDefined(i)){var s=angular.isDefined(n[1])?r(n[1]):!0;t[i]?angular.isArray(t[i])?t[i].push(s):t[i]=[t[i],s]:t[i]=s}}});return t}function o(e){var t=[];angular.forEach(e,function(e,n){angular.isArray(e)?angular.forEach(e,function(e){t.push(i(n,!0)+(e===!0?"":"="+i(e,!0)))}):t.push(i(n,!0)+(e===!0?"":"="+i(e,!0)))});return t.length?t.join("&"):""}return{require:"ngModel",link:function(r,i,u,a){var f=function(){return s(e.hash())},l=function(t){var n={};angular.forEach(t,function(e,t){e&&(n[t]=e)});e.hash(o(n));c&&e.replace()},c=t(u.replaceHistory)({})===!1?!1:!0,h=function(){var e=f();a.$setViewValue(e[u.ngModel]);a.$render()};a.$viewValue||h();r.$watch(u.ngModel,function(e){var t=f();t[u.ngModel]=a.$viewValue;l(t)});window.addEventListener("hashchange",function(){r.$apply(h)})}}}]);